<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Vendor — Perks Manager</title>
    <link rel="stylesheet" href="./vendor.css" />
    </head>
<body>
    <div id="soldacLinks" style="display:none; gap:10px;">
        <a class="btn" href="/producer/">Producer UI</a>
        <a class="btn" href="/vendor/">Manage</a>
        <a class="btn" href="/vendor/validate.html">Validate</a>
    </div>

    <div class="wrap">
        <div class="row" style="margin-top:10px;">
            <span class="muted">Language</span>
            <button id="langEN" class="btn small" type="button">EN</button>
            <button id="langPT" class="btn small" type="button">PT</button>
        </div>
        <header class="top">
            <div class="card" id="profileCard">
                <div class="form">
                    <h2 id="profileTitle" style="margin-top:0;"></h2>
                    <p id="profileHint" class="muted"></p>
                    <div class="grid">
                        <div>
                            <label class="label">Business name</label>
                            <input id="profileName" class="input" placeholder="e.g. Melgaço Film Museum" />
                        </div>

                        <div>
                            <label class="label">Address</label>
                            <input id="profileAddress" class="input" placeholder="Street, City, Country" />
                        </div>

                        <div>
                            <label class="label">Maps URL</label>
                            <input id="profileMapsUrl" class="input" placeholder="https://maps.google.com/?q=..." />
                        </div>
                    </div>

                    <div class="row" style="margin-top:10px;">
                        <button id="saveProfile" type="button" class="btn primary"></button>
                        <a id="profileDirections" class="btn" target="_blank" rel="noopener" style="display:none;">Directions</a>
                        <span id="profileStatus" class="muted"></span>
                    </div>
                </div>
            </div>

            <div>
                <h1>Vendor Perks</h1>
                <p class="muted">Manage your perks (enable/disable) and keep grams snapshot updated.</p>
            </div>

            <div class="auth">
                <label class="label">Business ID</label>
                <div class="row">
                    <input id="businessId" class="input" placeholder="e.g. Bar11" />
                </div>

                <label class="label" style="margin-top:10px;">Vendor Key</label>
                <div class="row">
                    <input id="vendorSecret" class="input" placeholder="••••••••" />
                    <button id="saveBusinessId" class="btn">Save</button>
                </div>
                <div style="margin-top:12px;">
                    <label>Onboarding link (safe)</label>
                    <input id="vendorOnboardUrl" readonly />
                    <button id="copyVendorOnboard">Copy</button>
                </div>

                <div style="margin-top:12px;">
                    <img id="vendorOnboardQr" alt="Vendor onboarding QR" style="max-width:220px;border:1px solid #ddd;border-radius:12px;padding:8px;" />
                </div>
                <div class="row">
                    <input id="gramId" class="input" placeholder="Optional: filter by gram_id (e.g. G002)" />
                    <button id="loadPerks" class="btn primary">Load perks</button>
                </div>

                <p id="status" class="status muted"></p>
            </div>
        </header>

        <main>
            <a class="btn primary" href="/vendor/validate.html">Validate a Gram</a>

            <div class="card" id="createPerkCard">
                <div class="card-head">
                    <h2>Create perk</h2>
                </div>

                <div class="form">
                    <div class="grid">
                        <div>
                            <label class="label">Gram ID</label>
                            <input id="createGramId" class="input" placeholder="e.g. G002" />
                        </div>

                        <div>
                            <label class="label">Business name (optional)</label>
                            <input id="createBusinessName" class="input" placeholder="e.g. BarDaEsquina" />
                        </div>

                        <div>
                            <label class="label">Type</label>
                            <select id="createType" class="input">
                                <option value="discount">discount</option>
                                <option value="free_item">free_item</option>
                                <option value="access">access</option>

                                <option value="shopify_discount">shopify_discount</option>
                                <option value="shopify_free_product">shopify_free_product</option>
                            </select>

                        </div>

                        <div>
                            <label class="label">Cooldown (seconds)</label>
                            <input id="createCooldown" class="input" type="number" placeholder="86400" />
                        </div>
                    </div>

                    <div id="createFields"></div>

                    <div class="row">
                        <button id="createPerk" class="btn primary">Create perk</button>
                    </div>
                </div>
            </div>
            <div class="card" id="profileCard">
                <div class="card-head">
                    <h2>Business profile</h2>
                </div>

                <div class="form">
                    <div class="grid">
                        <div>
                            <label class="label">Business name</label>
                            <input id="profileName" class="input" placeholder="e.g. Bar Da Esquina" />
                        </div>

                        <div>
                            <label class="label">Address</label>
                            <input id="profileAddress" class="input" placeholder="Street, City, Country" />
                        </div>

                        <div>
                            <label class="label">Maps URL</label>
                            <input id="profileMapsUrl" class="input" placeholder="https://maps.google.com/?q=..." />
                        </div>
                    </div>

                    <div class="row">
                        <button id="saveProfile" class="btn primary" type="button">Save profile</button>
                        <a id="mapsPreview" class="btn" target="_blank" rel="noopener" style="display:none;">Open Directions</a>
                        <span class="muted" id="profileStatus"></span>
                    </div>

                    <p class="muted" style="margin-top:10px;">
                        This information is shown to collectors when redeeming perks.
                    </p>
                </div>
            </div>

            <div class="card">
                <div class="card-head">
                    <h2>Perks</h2>
                    <div class="right">
                        <button id="refresh" class="btn">Refresh</button>
                    </div>
                </div>

                <div id="tableWrap" class="table-wrap">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Gram</th>
                                <th>Partner</th>
                                <th>Type</th>
                                <th>Details</th>
                                <th>Cooldown</th>
                                <th>Status</th>
                                <th style="width:170px;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="perksTbody">
                            <tr><td colspan="7" class="muted">Load perks to begin…</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="card">
                <div class="card-head">
                    <h2>Debug</h2>
                </div>
                <pre id="debug" class="pre muted">—</pre>
            </div>
        </main>
    </div>

    <script src="./vendor.js"></script>
</body>
</html>
